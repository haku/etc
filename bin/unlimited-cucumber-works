#!/bin/bash
LOG=/tmp/cucumber-works.log

COUNTER=0
print_report () {
  echo -e "\n\nExecuted $COUNTER times in $SECONDS seconds."
}

trap "exit" INT TERM
trap "print_report" EXIT

echo "log: $LOG"
while true ; do
  COUNTER=`expr $COUNTER + 1`
  bundle exec cucumber "$@" | tee -a "$LOG" | grep -m 1 "Failing Scenarios" && break
  echo -n "$COUNTER"
done
