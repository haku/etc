#!/bin/bash
set -eu

user="$USER"
hostname="$(hostname -s)"
date="$(date +'%Y%m%d')"
name="$user@$hostname.$date"
echo "name: $name"

file="$HOME/.ssh/$name"
file_pub="$file.pub"

if [ -e "$file" ] ; then
  echo "Exists: $file"
  exit 1
fi

if [ -e "$file_pub" ] ; then
  echo "Exists: $file_pub"
  exit 1
fi

ssh-keygen -t rsa \
  -b 8192 \
  -C "$name" \
  -f "$file"
